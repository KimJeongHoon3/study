로그

- 이벤트에 대한 기록
- 서비스 로그
  - 서비스 수전에서 일어나느 상태변화나 유저의 행동에 대한 기록들
  - ex. 유저의 입장 및 퇴장, 아이템 구매, 획득 및 사용 등
- 좋은로그?
  - 필요한 정보가 있는 로그
    - 목표가 뭐냐?
      - 목표를 한 문장으로 정의
      - 하나의 지표에 대해서 다양한 각도의 고민
      - 목표에 따라 남겨야 할 이벤트와 그 항목들을 정의
    - 일관성이 있냐?
      - 같은 구성요소에 대하여 같은 항목들을 가지는 것
        - 구성요소 Ex. "**플레이어**의 **아이템** 획득" 이벤트의 경우
          - 플레이어라는 구성요소와 아이템이라는 구성요소가 있다
          - 그냥 플레이어 아이템 DTO를 로그로 찍는게 아닌, 플레이어의 로그 포맷은 통일된 방식의 로그로 남기고, 아이템또한 통일된 포멧으로 로그를 남기도록..
    - 믿을 수 있냐? (여기는 조금.. 개발자의 실수영역..?)
      - 로그가 의도한 시점에서 발생했을것이라는 믿음
      - 의도한 대로 데이터가 남았을 것이라는 믿음
        - 의도한 것과 다른 데이터가 남을 수 있는 가능성
        - 어뷰징에 의한 변조 가능성
      - 100%는 아니더라도 납득할 수 있는 수준의 믿음을 위한 노력필요
  - 의미가 명확한 로그
    - 이름에 대한 합의와 규약
      - Naming Convention 을 정의하자
        - ex. 플레이어의 아이템획득
          - 이벤트이름 (<span style="color:red">구성요소와 행동을 별도로 정의해서 로그에 남겨야하나?</span>)
            - 구성요소 - Player, Item
            - 행동 - Get(Got)
          - 항목이름
            - 스네이크 표기법 (ex. player_level ...)
    - 이벤트를 구별하는 기준
    - 표현력
    - 빈 값의 의미를 명확하게

  - 편리하게 데이터를 얻을 수 있는 로그
    - 보통 json 많이씀
    - 메타데이터
      - 메타데이터란 서비스를 구성하는 정보에 대하여, 식별자와 그 상세정보가 매핑된 데이터
      - 메타데이터 사용은 언제하는게 좋을까?
        - 잘 변하지않거나 서비스 제공자만 변경할 수 있는 데이터들을 메타데이터로 관리.. 
    - 문맥식별자를 꼭 사용하자!
      - 서비스의 흐름을 알 수 있음
        - context_id
      - 하나의 요청에 대해서 요청이 처리될때까지 남는 모든 로그는 동일한 문맥 식별자를 가진다
    - 고유식별자
      - 로그 찍을때마다 가지는 식별자.. 유일한값이어야하나, 만약 두개이상이 되면 중복으로 찍힌 로그로 보면됨
- 로그의 문서화
  - 로그의 목표와 의미
  - 로그의 정확한 발생 시점
  - 각 항목들의 의미와 데이터 타입
  - 항목의 추가/변경/삭제 이력
  - 특이사항 기록(발생일시, 내용)
    - Ex. 로그 유실..
  - 로그가 사용되는 곳
    - 로그의 구조나 의미가 변경될 때 다른 지표에 대한 영향을 미리 파악할 수 있음
- 로그 추가 및 변경의 프로세스화
  1. 목표정의
     1. 추가(또는 변경)의 목표를 구체적으로 정의
     2. 어떤 데이터가 필요한 것인지 정의
  2. 관계자들의 의견을 종합하여 로그를 설계
     - 관계자?
       - 지표를 보는 사람들 / 만드는 사람들 (분석가)
       - 개발자(실제 로그에 대한 코드를 작성)
     - 이벤트 정의
     - 지표를 어떻게 볼 것인지 다양한 각도로 고민
     - 필요한 항목들을 더 구체적으로 정의
     - 추가 가능여부, 한계, 대안
     - 우선순위
     - 가까운 미래에 발생할 수 있는 다른 가능성 고민
     - 합의된 내용을 기반으로 문서화
         
  3. 로그 추가 또는 변경 작업
  4. 테스트/QA
  5. 배포


**미리 합의된 최소한의 규약이 필요하다!**


- [출처](https://speakerdeck.com/devinjeon/jamag-ndc19-joheun-rogeuran-mueosinga-joheun-rogeureul-wihae-goryeohaeya-hal-geosdeul)


- [로그레벨관련 내용정리굿](https://jojoldu.tistory.com/712)